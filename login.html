<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Login | Horarios</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:'Segoe UI',sans-serif;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
}
.login{
    background:#fff;
    padding:35px;
    width:340px;
    border-radius:18px;
    box-shadow:0 25px 50px rgba(0,0,0,.35);
    animation:fade 0.6s ease;
}
@keyframes fade{
    from{opacity:0;transform:translateY(20px)}
    to{opacity:1;transform:translateY(0)}
}
h2{
    text-align:center;
    margin-bottom:20px;
}
input{
    width:100%;
    padding:13px;
    margin:10px 0;
    border-radius:10px;
    border:1px solid #ccc;
}
.password{
    position:relative;
}
.password span{
    position:absolute;
    right:12px;
    top:50%;
    transform:translateY(-50%);
    cursor:pointer;
}
button{
    width:100%;
    padding:13px;
    border:none;
    border-radius:10px;
    background:#007bff;
    color:#fff;
    font-size:15px;
    cursor:pointer;
}
button:disabled{
    background:#999;
}
.msg{
    text-align:center;
    margin-top:12px;
    font-size:14px;
}
.error{color:#d00}
.ok{color:green}
</style>
</head>

<body>

<div class="login">
    <h2>Iniciar sesi√≥n</h2>

    <input id="user" placeholder="Usuario">

    <div class="password">
        <input id="pass" type="password" placeholder="Contrase√±a">
        <span onclick="togglePass()">üëÅÔ∏è</span>
    </div>

    <button id="btn" onclick="login()">Entrar</button>

    <div class="msg" id="msg"></div>
</div>

<script>
const API_USERS="https://sheetdb.io/api/v1/8e8s3339432n3";

if(localStorage.getItem("sesion")){
    location.href="index.html";
}

function togglePass(){
    pass.type = pass.type==="password" ? "text" : "password";
}

function login(){
    msg.innerText="Verificando...";
    msg.className="msg";
    btn.disabled=true;

    fetch(API_USERS)
    .then(r=>r.json())
    .then(users=>{
        const u = users.find(x =>
            x.USUARIO === user.value &&
            x.CONTRASENA === pass.value
        );

        if(u){
            localStorage.setItem("sesion","true");
            localStorage.setItem("nombre",u.NOMBRE);
            msg.innerText="Acceso concedido ‚úî";
            msg.className="msg ok";
            setTimeout(()=>location.href="index.html",800);
        }else{
            msg.innerText="Usuario o contrase√±a incorrectos";
            msg.className="msg error";
            btn.disabled=false;
        }
    })
    .catch(()=>{
        msg.innerText="Error al conectar con el servidor";
        msg.className="msg error";
        btn.disabled=false;
    });
}
</script>

</body>
</html>

